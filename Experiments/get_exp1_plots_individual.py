import matplotlib
import matplotlib.pyplot as plt

plt.style.use("seaborn")

matplotlib.rcParams["mathtext.fontset"] = "stix"
matplotlib.rcParams["font.family"] = "STIXGeneral"
matplotlib.rc("font", size=26)
matplotlib.rc("axes", titlesize=22)
matplotlib.rc("axes", labelsize=28)
matplotlib.rc("xtick", labelsize=22)
matplotlib.rc("ytick", labelsize=22)
matplotlib.rc("legend", fontsize=18)
matplotlib.rc("figure", titlesize=18)
lylim = 0.8
uylim = 1.01
version = 5

# fig = plt.figure(figsize=(15, 4))
# ax1 = fig.add_axes([0.075, 0.2, 0.25, 0.75])
# ax2 = fig.add_axes([0.35, 0.2, 0.3, 0.75])
# ax3 = fig.add_axes([0.675, 0.2, 0.3, 0.75])

# fig = plt.figure(figsize=(9, 9))
# ax1 = fig.add_axes([0.15, 0.6, 0.4, 0.325])
# ax2 = fig.add_axes([0.6, 0.6, 0.4, 0.325])
# ax3 = fig.add_axes([0.15, 0.175, 0.4, 0.325])

# plt.text(
#     1.6,
#     0.5,
#     r"$\bf{Figure 1}$"
#     + ": Experiment 1:\nMistle demonstrates\naccurate learning of\ntheories.",
#     bbox={"facecolor": "white", "alpha": 1, "edgecolor": "none", "pad": 1},
#     ha="center",
#     va="center",
#     transform=ax3.transAxes,
# )

fig1 = plt.figure(figsize=(4, 4))
ax1 = fig1.add_axes([0.075, 0.2, 0.95, 0.8])
# ax1 = fig.add_axes([0.525, 0.22, 0.45, 0.75])
ax1.set_xlabel("Missingness Parameter")
ax1.set_xticks([0, 0.1, 0.2, 0.3, 0.4, 0.5])
ax1.set_xticklabels(["0", "0.1", "0.2", "0.3", "0.4", "0.5"])
ax1.set_ylim(bottom=lylim, top=uylim)
ax1.set_ylabel("Accuracy")
ax1.set_yticks([0.8, 0.85, 0.9, 0.95, 1])
ax1.set_yticklabels(["0.8", "0.85", "0.9", "0.95", "1.0"])

# missingness_parameters = [0, 0.1, 0.2, 0.3, 0.4, 0.5]
# mean_similarity_list2 = [
#     0.9915364583333334,
#     0.9873046875,
#     0.9588216145833334,
#     0.9892578125,
#     0.9934895833333334,
#     0.9938151041666666,
# ]
# lstd_dev_similarity_list2 = [
#     0.9794702128952796,
#     0.9719505906195051,
#     0.8887035656825196,
#     0.976184999585405,
#     0.9862428140055498,
#     0.9876800942763595,
# ]
# ustd_dev_similarity_list2 = [1, 1, 1, 1, 1, 0.9999501140569738]

missingness_parameters = [0, 0.1, 0.2, 0.3, 0.4, 0.5]
# mean_similarity_list2 = [
#     0.9105499267578125,
#     0.8725616455078125,
#     0.8701470947265625,
#     0.9439141845703125,
#     0.932012939453125,
#     0.9054693603515624,
# ]
# std_dev_similarity_list2 = [
#     0.2343597626107986,
#     0.2933108497776877,
#     0.29589587458192945,
#     0.19426318422022765,
#     0.21560589764435656,
#     0.2688686071510578,
# ]
# lstd_dev_similarity_list2 = [
#     0.6761901641470139,
#     0.5792507957301247,
#     0.574251220144633,
#     0.7496510003500849,
#     0.7164070418087685,
#     0.6366007532005047,
# ]
# ustd_dev_similarity_list2 = [1, 1, 1, 1, 1, 1]

# mean_similarity_list2 = [
#     0.79010009765625,
#     0.593304443359375,
#     0.581793212890625,
#     0.575555419921875,
#     0.57598876953125,
#     0.4614990234375,
# ]
# std_dev_similarity_list2 = [
#     0.4165616817137228,
#     0.5107086686480928,
#     0.5007605517234871,
#     0.49581864543772686,
#     0.4963935161642747,
#     0.4877697896387786,
# ]
# lstd_dev_similarity_list2 = [
#     0.3735384159425272,
#     0.08259577471128221,
#     0.08103266116713792,
#     0.07973677448414812,
#     0.07959525336697532,
#     0,
# ]
# ustd_dev_similarity_list2 = [1, 1, 1, 1, 1, 0.9492688130762785]

# missingness_parameters2 = [0.5, 0.4, 0.3, 0.2, 0.1, 0]
# mean_similarity_list2 = [
#     0.5549163818359375,
#     0.6341937255859375,
#     0.723653564453125,
#     0.7656402587890625,
#     0.8858673095703125,
#     0.9307659912109375,
# ]
# std_dev_similarity_list2 = [
#     0.4665478859647343,
#     0.4511280237550037,
#     0.421392259614817,
#     0.39933421950115044,
#     0.2863688528025004,
#     0.21982525768761768,
# ]
# lstd_dev_similarity_list2 = [
#     0.08836849587120321,
#     0.18306570183093374,
#     0.302261304838308,
#     0.36630603928791206,
#     0.5994984567678121,
#     0.7109407335233198,
# ]
# ustd_dev_similarity_list2 = [1, 1, 1, 1, 1, 1]

missingness_parameters2 = [0.5, 0.4, 0.3, 0.2, 0.1, 0]
mean_similarity_list2 = [
    0.98162718493529,
    0.975629625822368,
    0.973443863239694,
    0.977304982615041,
    0.970792277475421,
    0.960465542105741,
]
std_dev_similarity_list2 = [
    0.0345625429581034,
    0.0270718629915969,
    0.039845825498706,
    0.0290819126837755,
    0.0363602754861492,
    0.0732061088857305,
]
lstd_dev_similarity_list2 = [
    0.947064641977187,
    0.948557762830772,
    0.933598037740988,
    0.948223069931266,
    0.934432001989272,
    0.887259433220011,
]
ustd_dev_similarity_list2 = [1, 1, 1, 1, 1, 1]

missingness_parameters2.reverse()
mean_similarity_list2.reverse()
lstd_dev_similarity_list2.reverse()
ustd_dev_similarity_list2.reverse()

ax1.plot(missingness_parameters, mean_similarity_list2, marker="o")
ax1.fill_between(
    missingness_parameters,
    lstd_dev_similarity_list2,
    ustd_dev_similarity_list2,
    alpha=0.3,
)

plt.savefig("exp1_plot1_v" + str(version) + ".pdf", bbox_inches="tight")
plt.show()
plt.close()

fig2 = plt.figure(figsize=(4, 4))
ax2 = fig2.add_axes([0.075, 0.2, 0.8, 0.8])
# ax2 = fig.add_axes([0.1, 0.22, 0.4, 0.75])
ax2.set_ylim(bottom=lylim, top=uylim)
ax2.set_ylabel("Accuracy")
ax2.set_yticks([0.8, 0.85, 0.9, 0.95, 1])
ax2.set_yticklabels(["0.8", "0.85", "0.9", "0.95", "1.0"])
ax2.set_xticks([100, 200, 300, 400, 500])
ax2.set_xticklabels(["100", "200", "300", "400", "500"])
ax2.set_xlabel("Number of examples")
# data_sizes = [100, 150, 200, 250, 300, 350, 400, 450, 500]
# mean_similarity_list1 = [
#     0.970703125,
#     0.9612630208333334,
#     0.9879557291666666,
#     0.9887152777777778,
#     0.98828125,
#     0.9928385416666666,
#     0.9780815972222222,
#     0.9621310763888888,
#     0.9930555555555556,
# ]
# lstd_dev_similarity_list1 = [
#     0.9413006460599129,
#     0.9168347931353727,
#     0.9687879689846446,
#     0.9733665303661622,
#     0.9724666652922835,
#     0.9815445636332483,
#     0.9570168525842913,
#     0.9191490733230527,
#     0.9856271872565686,
# ]
# ustd_dev_similarity_list1 = [1, 1, 1, 1, 1, 1, 0.9991463418601532, 1, 1]

# data_sizes = [100, 150, 200, 250, 300, 350, 400, 450, 500]
# mean_similarity_list1 = [
#     0.8685711669921875,
#     0.8943780517578125,
#     0.9211541748046875,
#     0.89572509765625,
#     0.8922027587890625,
#     0.913797607421875,
#     0.9280670166015625,
#     0.9300970458984374,
#     0.9351483154296875,
# ]
# std_dev_similarity_list1 = [
#     0.21013777824796837,
#     0.1697991198018499,
#     0.16814221542075158,
#     0.23031493739608433,
#     0.24800759418762414,
#     0.21276205626494404,
#     0.1925880368252782,
#     0.19255174592500943,
#     0.19311111716360568,
# ]
# lstd_dev_similarity_list1 = [
#     0.6584333887442191,
#     0.7245789319559626,
#     0.753011959383936,
#     0.6654101602601656,
#     0.6441951646014383,
#     0.701035551156931,
#     0.7354789797762844,
#     0.737545299973428,
#     0.7420371982660818,
# ]
# ustd_dev_similarity_list1 = [1, 1, 1, 1, 1, 1, 1, 1, 1]

# data_sizes = [100, 150, 200, 250, 300, 350, 400, 450, 500]
# mean_similarity_list2 = [
#     0.6957574462890626,
#     0.709674072265625,
#     0.8008343505859375,
#     0.8249102783203125,
#     0.8644976806640625,
#     0.8065380859375,
#     0.8176226806640625,
#     0.8469671630859374,
#     0.8526446533203125,
# ]
# std_dev_similarity_list2 = [
#     0.38791625975274296,
#     0.4134255268267219,
#     0.35292936940424147,
#     0.34145692089662166,
#     0.30670017410256467,
#     0.36858981261424756,
#     0.36021309575508853,
#     0.33168970145769605,
#     0.3253383135015523,
# ]
# lstd_dev_similarity_list2 = [
#     0.3078411865363196,
#     0.29624854543890305,
#     0.4479049811816961,
#     0.48345335742369083,
#     0.5577975065614978,
#     0.4379482733232524,
#     0.457409584908974,
#     0.5152774616282414,
#     0.5273063398187602,
# ]
# ustd_dev_similarity_list2 = [1, 1, 1, 1, 1, 1, 1, 1, 1]

data_sizes = [100, 150, 200, 250, 300, 350, 400, 450, 500]
mean_similarity_list2 = [
    0.925810761504121,
    0.946483324932796,
    0.956775952410954,
    0.959225234164987,
    0.968903572328629,
    0.974138440583882,
    0.975629625822368,
    0.976776123046875,
    0.984042138168492,
]
std_dev_similarity_list2 = [
    0.0745959897168294,
    0.0567042487754956,
    0.0450881681110654,
    0.0453760085272736,
    0.0293853317406726,
    0.0272610257459852,
    0.0270718629915969,
    0.043340144769927,
    0.018706607486442,
]
lstd_dev_similarity_list2 = [
    0.851214771787292,
    0.8897790761573,
    0.911687784299889,
    0.913849225637713,
    0.939518240587956,
    0.946877414837896,
    0.948557762830772,
    0.933435978276948,
    0.96533553068205,
]
ustd_dev_similarity_list2 = [1, 1, 1, 1, 0.998288904069, 1, 1, 1, 1]

ax2.plot(data_sizes, mean_similarity_list2, marker="o")
ax2.fill_between(
    data_sizes, lstd_dev_similarity_list2, ustd_dev_similarity_list2, alpha=0.3
)
plt.savefig("exp1_plot2_v" + str(version) + ".pdf", bbox_inches="tight")
plt.show()
plt.close()

fig3 = plt.figure(figsize=(4, 4))
ax3 = fig3.add_axes([0.075, 0.2, 0.95, 0.8])
ax3.set_xlabel("Number of variables")
ax3.set_xticks([4, 6, 8, 10, 12, 14, 16])
ax3.set_xticklabels(["4", "6", "8", "10", "12", "14", "16"])
ax3.set_ylim(bottom=lylim, top=uylim)
ax3.set_yticks([0.8, 0.85, 0.9, 0.95, 1])
ax3.set_ylabel("Accuracy")
ax3.set_yticklabels(["0.8", "0.85", "0.9", "0.95", "1.0"])
# ax3.set_yticks([0, 0.2, 0.4, 0.6, 0.8, 1])

# alphabet_sizes = [4, 6, 8, 10, 12]
# mean_similarity_list3 = [
#     0.995849609375,
#     0.98212890625,
#     0.98037109375,
#     0.9890625,
#     0.99892578125,
# ]
# lstd_dev_similarity_list3 = [
#     0.9897071554563432,
#     0.959844871234933,
#     0.9524569467951004,
#     0.971236555923274,
#     0.9965237551022951,
# ]
# ustd_dev_similarity_list3 = [1, 1, 1, 1, 1]
# alphabet_sizes = [4, 6, 8, 10, 12, 14, 16]
# mean_similarity_list3 = [
#     0.98,
#     0.979375,
#     0.986484375,
#     0.90728515625,
#     0.94330322265625,
#     0.92934814453125,
#     0.9324873352050781,
# ]
# std_dev_similarity_list3 = [
#     0.14070529413628968,
#     0.14066673062076673,
#     0.09993694128236881,
#     0.26940701808792844,
#     0.19449554624213153,
#     0.19285295956405774,
#     0.167992814740012,
# ]
# lstd_dev_similarity_list3 = [
#     0.8392947058637104,
#     0.8387082693792333,
#     0.8865474337176311,
#     0.6378781381620715,
#     0.7488076764141185,
#     0.7364951849671924,
#     0.7644945204650662,
# ]
# ustd_dev_similarity_list3 = [1, 1, 1, 1, 1, 1, 1]

# alphabet_sizes = [4, 6, 8, 10, 12, 14, 16]
# mean_similarity_list3 = [
#     0.9975,
#     0.98265625,
#     0.947421875,
#     0.91458984375,
#     0.82591064453125,
#     0.8181964111328125,
#     0.7441043090820313,
# ]
# std_dev_similarity_list3 = [
#     0.025,
#     0.10015708838229923,
#     0.19485854757989535,
#     0.24238619224002755,
#     0.3400858259825418,
#     0.36188719880928694,
#     0.4206938221244181,
# ]
# lstd_dev_similarity_list3 = [
#     0.9725,
#     0.8824991616177008,
#     0.7525633274201047,
#     0.6722036515099724,
#     0.4858248185487082,
#     0.45630921232352556,
#     0.3234104869576132,
# ]

alphabet_sizes = [4, 6, 8, 10, 12, 14, 16]
mean_similarity_list3 = [
    1,
    0.99828125,
    0.992578125,
    0.9791015625,
    0.978338747608418,
    0.975629625822368,
    0.974636874356113,
]
std_dev_similarity_list3 = [
    0,
    0.00539211730002907,
    0.0123962411602125,
    0.0342724267203213,
    0.0322672799008935,
    0.0270718629915969,
    0.0295307863510468,
]
lstd_dev_similarity_list3 = [
    1,
    0.992889132699971,
    0.980181883839787,
    0.944829135779679,
    0.946071467707525,
    0.948557762830772,
    0.945106088005066,
]
ustd_dev_similarity_list3 = [1, 1, 1, 1, 1, 1, 1]

ax3.plot(alphabet_sizes, mean_similarity_list3, marker="o")
ax3.fill_between(
    alphabet_sizes, lstd_dev_similarity_list3, ustd_dev_similarity_list3, alpha=0.3
)

plt.savefig("exp1_plot3_v" + str(version) + ".pdf", bbox_inches="tight")
plt.show()
plt.close()
